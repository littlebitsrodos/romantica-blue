let currentLang="en",currentMonth=(new Date).getMonth(),currentYear=(new Date).getFullYear(),bookedDates=[];function initLanguageSwitcher(){const e=document.querySelectorAll(".lang-btn");e.forEach(t=>{t.addEventListener("click",()=>{setLanguage(t.dataset.lang),e.forEach(e=>e.classList.remove("active")),t.classList.add("active")})})}function setLanguage(e){currentLang=e;const t=translations[e];document.querySelectorAll("[data-translate]").forEach(e=>{const n=e.dataset.translate.split(".");let r=t;for(const e of n)r=r?.[e];r&&(e.textContent=r)}),document.querySelectorAll("[data-translate-placeholder]").forEach(e=>{const n=e.dataset.translatePlaceholder.split(".");let r=t;for(const e of n)r=r?.[e];r&&(e.placeholder=r)}),document.documentElement.lang="el"===e?"el":e,renderCalendar()}function initNavigation(){const e=document.querySelector(".navbar"),t=document.querySelector(".mobile-menu-btn"),n=document.querySelector(".nav-links");window.addEventListener("scroll",()=>{window.scrollY>50?e.classList.add("scrolled"):e.classList.remove("scrolled")}),t&&t.addEventListener("click",()=>{n.classList.toggle("active")}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const r=document.querySelector(e.getAttribute("href"));r&&(r.scrollIntoView({behavior:"smooth",block:"start"}),n?.classList.remove("active"))})})}document.addEventListener("DOMContentLoaded",()=>{initLanguageSwitcher(),initNavigation(),initGallery(),initCalendar(),initContactForm(),initScrollAnimations(),setLanguage("en")});let galleryRotationInterval=null,currentGalleryIndex=0,currentLightboxIndex=0,galleryImages=[],touchStartX=0,touchEndX=0;function initGallery(){const e=document.querySelectorAll(".gallery-item"),t=document.querySelector(".lightbox"),n=t?.querySelector("img"),r=t?.querySelector(".lightbox-close"),a=t?.querySelector(".lightbox-prev"),o=t?.querySelector(".lightbox-next"),l=document.querySelector(".gallery-grid");galleryImages=Array.from(e).map(e=>({src:e.querySelector("img")?.src,alt:e.querySelector("img")?.alt})),initMobileCarousel(),startGalleryRotation(),l&&(l.addEventListener("mouseenter",()=>stopGalleryRotation()),l.addEventListener("mouseleave",()=>startGalleryRotation())),e.forEach((e,t)=>{e.addEventListener("click",()=>openLightbox(t))}),r&&r.addEventListener("click",closeLightbox),a&&a.addEventListener("click",()=>navigateLightbox(-1)),o&&o.addEventListener("click",()=>navigateLightbox(1)),t&&(t.addEventListener("click",e=>{e.target===t&&closeLightbox()}),t.addEventListener("touchstart",e=>{touchStartX=e.changedTouches[0].screenX},{passive:!0}),t.addEventListener("touchend",e=>{touchEndX=e.changedTouches[0].screenX,handleLightboxSwipe()},{passive:!0})),document.addEventListener("keydown",e=>{const t=document.querySelector(".lightbox");t?.classList.contains("active")&&("Escape"===e.key&&closeLightbox(),"ArrowLeft"===e.key&&navigateLightbox(-1),"ArrowRight"===e.key&&navigateLightbox(1))}),n&&(n.style.cursor="pointer",n.addEventListener("click",e=>{const t=n.getBoundingClientRect();navigateLightbox(e.clientX-t.left<t.width/3?-1:1)}))}function initMobileCarousel(){const e=document.querySelector(".gallery-carousel"),t=e?.querySelector(".carousel-track"),n=e?.querySelectorAll(".carousel-slide"),r=e?.querySelector(".carousel-prev"),a=e?.querySelector(".carousel-next"),o=e?.querySelector(".carousel-dots");if(!e||!n?.length)return;let l=0,c=null;function s(e){l=e,l<0&&(l=n.length-1),l>=n.length&&(l=0),t.style.transform=`translateX(-${100*l}%)`,o?.querySelectorAll(".carousel-dot").forEach((e,t)=>{e.classList.toggle("active",t===l)})}function i(){s(l+1)}function d(){s(l-1)}n.forEach((e,t)=>{const n=document.createElement("button");n.className="carousel-dot "+(0===t?"active":""),n.setAttribute("aria-label",`Go to slide ${t+1}`),n.addEventListener("click",()=>s(t)),o?.appendChild(n)}),r?.addEventListener("click",d),a?.addEventListener("click",i);let u=0;function g(){h(),c=setInterval(i,6e3)}function h(){c&&clearInterval(c)}t?.addEventListener("touchstart",e=>{u=e.changedTouches[0].screenX,h()},{passive:!0}),t?.addEventListener("touchend",e=>{const t=e.changedTouches[0].screenX,n=u-t;Math.abs(n)>50&&(n>0?i():d()),g()},{passive:!0}),n.forEach((e,t)=>{e.addEventListener("click",()=>openLightbox(t))}),g()}function openLightbox(e){const t=document.querySelector(".lightbox"),n=t?.querySelector("img"),r=t?.querySelector(".lightbox-counter .current"),a=t?.querySelector(".lightbox-counter .total");t&&n&&galleryImages[e]&&(currentLightboxIndex=e,n.src=galleryImages[e].src,n.alt=galleryImages[e].alt,r&&(r.textContent=e+1),a&&(a.textContent=galleryImages.length),t.classList.add("active"),document.body.style.overflow="hidden",stopGalleryRotation())}function navigateLightbox(e){currentLightboxIndex+=e,currentLightboxIndex<0&&(currentLightboxIndex=galleryImages.length-1),currentLightboxIndex>=galleryImages.length&&(currentLightboxIndex=0);const t=document.querySelector(".lightbox"),n=t?.querySelector("img"),r=t?.querySelector(".lightbox-counter .current");n&&galleryImages[currentLightboxIndex]&&(n.src=galleryImages[currentLightboxIndex].src,n.alt=galleryImages[currentLightboxIndex].alt),r&&(r.textContent=currentLightboxIndex+1)}function handleLightboxSwipe(){const e=touchStartX-touchEndX;Math.abs(e)>50&&navigateLightbox(e>0?1:-1)}function startGalleryRotation(){const e=document.querySelectorAll(".gallery-item");0!==e.length&&(stopGalleryRotation(),galleryRotationInterval=setInterval(()=>{e.forEach(e=>e.classList.remove("gallery-highlight")),currentGalleryIndex=(currentGalleryIndex+1)%e.length,e[currentGalleryIndex].classList.add("gallery-highlight")},5e3))}function stopGalleryRotation(){galleryRotationInterval&&(clearInterval(galleryRotationInterval),galleryRotationInterval=null),document.querySelectorAll(".gallery-item").forEach(e=>{e.classList.remove("gallery-highlight")})}function closeLightbox(){const e=document.querySelector(".lightbox");e&&(e.classList.remove("active"),document.body.style.overflow="",startGalleryRotation())}function initCalendar(){loadBookedDates();const e=document.querySelector(".calendar-prev"),t=document.querySelector(".calendar-next");e&&e.addEventListener("click",()=>{currentMonth--,currentMonth<0&&(currentMonth=11,currentYear--),renderCalendar()}),t&&t.addEventListener("click",()=>{currentMonth++,currentMonth>11&&(currentMonth=0,currentYear++),renderCalendar()}),renderCalendar()}function loadBookedDates(){const e=new Date;bookedDates=[formatDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+3)),formatDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+4)),formatDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+5)),formatDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+6)),formatDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+7)),formatDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+15)),formatDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+16)),formatDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+17)),formatDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+18))]}async function fetchICalData(e){try{const t=await fetch(e);return parseICalData(await t.text())}catch(e){return console.error("Error fetching iCal data:",e),[]}}function parseICalData(e){const t=[],n=e.split("\n");let r=!1,a=null,o=null;for(const e of n)if(e.startsWith("BEGIN:VEVENT"))r=!0;else if(e.startsWith("END:VEVENT")){if(a&&o){let e=new Date(a);const n=new Date(o);for(;e<n;)t.push(formatDate(e)),e.setDate(e.getDate()+1)}r=!1,a=null,o=null}else if(r)if(e.startsWith("DTSTART")){const t=e.match(/(\d{4})(\d{2})(\d{2})/);t&&(a=`${t[1]}-${t[2]}-${t[3]}`)}else if(e.startsWith("DTEND")){const t=e.match(/(\d{4})(\d{2})(\d{2})/);t&&(o=`${t[1]}-${t[2]}-${t[3]}`)}return t}function formatDate(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function renderCalendar(){const e=document.querySelector(".calendar"),t=document.querySelector(".calendar-month");if(!e)return;const n=translations[currentLang].calendar;t&&(t.textContent=`${n.months[currentMonth]} ${currentYear}`),e.innerHTML="",n.days.forEach(t=>{const n=document.createElement("div");n.className="calendar-header",n.textContent=t,e.appendChild(n)});const r=new Date(currentYear,currentMonth,1).getDay(),a=new Date(currentYear,currentMonth+1,0).getDate(),o=new Date;for(let t=0;t<r;t++){const t=document.createElement("div");t.className="calendar-day empty",e.appendChild(t)}for(let t=1;t<=a;t++){const n=formatDate(new Date(currentYear,currentMonth,t)),r=document.createElement("div");r.className="calendar-day",r.textContent=t;new Date(currentYear,currentMonth,t)<new Date(o.getFullYear(),o.getMonth(),o.getDate())||bookedDates.includes(n)?r.classList.add("booked"):r.classList.add("available"),e.appendChild(r)}}function initContactForm(){const e=document.querySelector(".contact-form form");e&&e.addEventListener("submit",t=>{t.preventDefault();const n=new FormData(e),r=Object.fromEntries(n);r.name&&r.email&&r.message?isValidEmail(r.email)?(console.log("Form submitted:",r),showFormMessage("Thank you! We'll get back to you soon.","success"),e.reset()):showFormMessage("Please enter a valid email address.","error"):showFormMessage("Please fill in all required fields.","error")})}function isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}function showFormMessage(e,t){const n=document.querySelector(".form-message");n&&n.remove();const r=document.createElement("div");r.className=`form-message ${t}`,r.textContent=e,r.style.cssText=`\n    padding: 1rem;\n    margin-top: 1rem;\n    border-radius: 8px;\n    text-align: center;\n    ${"success"===t?"background: #d4edda; color: #155724;":"background: #f8d7da; color: #721c24;"}\n  `;document.querySelector(".contact-form form").appendChild(r),setTimeout(()=>{r.remove()},5e3)}function initScrollAnimations(){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("animate-in"),e.unobserve(t.target))})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});document.querySelectorAll("section, .amenity-card, .bedroom-card").forEach(t=>{t.style.opacity="0",e.observe(t)})}